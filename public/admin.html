<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - JL Max</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/tables.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body class="bg-dark">
    <header class="w-100 p-3">
        <h1>Cat√°logo de Filmes</h1>
        <img src="Fotos/logo.png" alt="Logo do site" class="logo">
        <div class="d-flex flex-column align-items-end mt-2 me-4">
            <form action="pesquisar.php" method="GET" class="search-form d-flex align-items-center mb-3">
                <input type="search" name="q" placeholder="Digite sua busca...">
                <button type="submit">üîç</button>
            </form>
            <nav class="navbar navbar-expand-md navbar-custom">
                <div class="container-fluid">
                    <button class="navbar-toggler d-md-none" type="button" data-bs-toggle="collapse"
                        data-bs-target="#menuMobile" aria-controls="menuMobile" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="menuMobile">
                        <ul class="navbar-nav text-end">
                            <li class="nav-item"><a href="index.html">P√°gina Inicial</a></li>
                            <li class="nav-item"><a href="#">Categorias</a></li>
                            <li class="nav-item"><a href="#">G√™neros</a></li>
                            <li class="nav-item"><a href="#">Ano</a></li>
                            <li class="nav-item"><a href="favoritos.html">Favoritos</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    <div class="button-container mt-3 text-end">
        <a href="index.html" class="btn btn-secondary mb-3">Voltar</a>
        <button id="logout-btn" class="btn btn-danger btn-logout-custom ms-2"><i class="fas fa-sign-out-alt"></i> Sair</button>
    </div>
    <main class="pt-5">
        <div class="container">
            <h2 class="mb-4">Cadastro de Filmes</h2>
            <form id="form-filme" class="needs-validation" novalidate>
                <div class="mb-3">
                    <label for="id" class="form-label">ID</label>
                    <input type="text" class="form-control" id="id">
                </div>
                <div class="mb-3">
                    <label for="titulo" class="form-label">T√≠tulo</label>
                    <input type="text" class="form-control" id="titulo" required>
                </div>
                <div class="mb-3">
                    <label for="imagem" class="form-label">URL da Imagem</label>
                    <input type="text" class="form-control" id="imagem" required>
                </div>
                <div class="mb-3">
                    <label for="imagemCarrossel" class="form-label">URL da Imagem do Carrossel</label>
                    <input type="text" class="form-control" id="imagemCarrossel">
                </div>
                <div class="mb-3">
                    <label for="sinopse" class="form-label">Sinopse</label>
                    <textarea class="form-control" id="sinopse" rows="4" required></textarea>
                </div>
                <div class="mb-3">
                    <label for="ano" class="form-label">Ano</label>
                    <input type="text" class="form-control" id="ano" required>
                </div>
                <div class="mb-3">
                    <label for="genero" class="form-label">G√™nero</label>
                    <input type="text" class="form-control" id="genero" required>
                </div>
                <div class="mb-3">
                    <label for="trailerId" class="form-label">ID do Trailer (YouTube)</label>
                    <input type="text" class="form-control" id="trailerId">
                </div>
                <div class="mb-3">
                    <label for="elenco" class="form-label">Elenco</label>
                    <input type="text" class="form-control" id="elenco">
                </div>
                <div class="mb-3">
                    <label for="direcao" class="form-label">Dire√ß√£o</label>
                    <input type="text" class="form-control" id="direcao">
                </div>
                <div class="mb-3">
                    <label for="duracao" class="form-label">Dura√ß√£o</label>
                    <input type="text" class="form-control" id="duracao">
                </div>
                <div class="mb-3">
                    <label for="avaliacao" class="form-label">Avalia√ß√£o</label>
                    <input type="text" class="form-control" id="avaliacao">
                </div>
                <button type="submit" class="btn btn-primary">Cadastrar</button>
            </form>
            <h3 class="mt-5">Filmes Cadastrados</h3>
            <table class="table table-dark">
                <thead>
                    <tr>
                        <th>T√≠tulo</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="filmes-tbody"></tbody>
            </table>
        </div>
    </main>
    <footer class="py-4">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 text-center mb-4">
                    <ul class="footer-links list-unstyled d-flex justify-content-center flex-wrap gap-3 mb-3">
                        <li><a href="#">Termos de Uso</a></li>
                        <li><a href="#">Pol√≠tica de Privacidade</a></li>
                        <li><a href="#">Contato</a></li>
                    </ul>
                    <p>¬© 2025 JL Max - Todos os direitos reservados.</p>
                </div>
                <div class="col-12 text-center">
                    <div class="autoria-container">
                        <div class="profile-pic-container">
                            <img src="Fotos/autoria.jpg" alt="Jo√£o Mancini" class="profile-pic">
                        </div>
                        <div class="autoria-texto">
                            <h6 class="dadostitulo">Informa√ß√µes do(a) Aluno(a)</h6>
                            <div class="info-item">Aluno: Jo√£o Lemos</div>
                            <div class="info-item">Curso: Ci√™ncia da Computa√ß√£o</div>
                            <div class="info-item">Turma: Manh√£</div>
                            <div class="social-links">
                                <span class="me-2">Redes Sociais:</span>
                                <a href="https://instagram.com/joaomancini_" class="me-2" target="_blank">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram" style="width: 20px; height: 20px;">
                                </a>
                                <a href="https://github.com/joaomancini" target="_blank">
                                    <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" style="width: 20px; height: 20px;">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="js/config.js"></script>
    <script src="js/utilis.js"></script>
    <script src="js/admin.js"></script>
    <script>
        // Carregar filmes ao iniciar
        async function carregarFilmes() {
            const response = await fetch('http://localhost:3000/filmes');
            const filmes = await response.json();
            const tbody = document.getElementById('filmes-tbody');
            tbody.innerHTML = '';
            filmes.forEach(filme => {
                const tr = document.createElement('tr');
                tr.setAttribute('data-id', filme.id);
                tr.innerHTML = `
                    <td>${filme.titulo}</td>
                    <td>
                        <button onclick="editarFilme('${filme.id}')">Editar</button>
                        <button onclick="excluirFilme('${filme.id}')">Excluir</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Enviar novo filme
        document.getElementById('form-filme').addEventListener('submit', async (e) => {
            e.preventDefault();
            const filme = {
                id: document.getElementById('id').value || `filme${Date.now()}`, // Gera ID √∫nico se n√£o fornecido
                titulo: document.getElementById('titulo').value,
                imagem: document.getElementById('imagem').value,
                imagemCarrossel: document.getElementById('imagemCarrossel').value,
                sinopse: document.getElementById('sinopse').value,
                ano: document.getElementById('ano').value,
                genero: document.getElementById('genero').value,
                trailerId: document.getElementById('trailerId').value,
                elenco: document.getElementById('elenco').value,
                direcao: document.getElementById('direcao').value,
                duracao: document.getElementById('duracao').value,
                avaliacao: document.getElementById('avaliacao').value
            };
            await fetch('http://localhost:3000/filmes', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(filme)
            });
            alert('Filme cadastrado!');
            document.getElementById('form-filme').reset();
            carregarFilmes();
        });

        // Editar filme
        async function editarFilme(id) {
            const filmeExistente = await (await fetch(`http://localhost:3000/filmes/${id}`)).json();
            const novoTitulo = prompt('Novo t√≠tulo:', filmeExistente.titulo);
            if (novoTitulo) {
                const filme = {
                    id: id,
                    titulo: novoTitulo,
                    imagem: filmeExistente.imagem,
                    imagemCarrossel: filmeExistente.imagemCarrossel,
                    sinopse: filmeExistente.sinopse,
                    ano: filmeExistente.ano,
                    genero: filmeExistente.genero,
                    trailerId: filmeExistente.trailerId,
                    elenco: filmeExistente.elenco,
                    direcao: filmeExistente.direcao,
                    duracao: filmeExistente.duracao,
                    avaliacao: filmeExistente.avaliacao
                };
                await fetch(`http://localhost:3000/filmes/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(filme)
                });
                carregarFilmes();
            }
        }

        // Excluir filme
        async function excluirFilme(id) {
            if (confirm('Tem certeza que deseja excluir este filme?')) {
                await fetch(`http://localhost:3000/filmes/${id}`, {
                    method: 'DELETE'
                });
                carregarFilmes();
            }
        }

        // Carregar filmes ao iniciar
        window.onload = carregarFilmes;
    </script>
</body>
</html>